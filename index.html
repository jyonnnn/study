<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Flashcards of Hjyeon</title>
  <style>
    :root{
      --bg:#ffffff;
      --card:#f2d7d3; /* khung chính màu hồng nhạt */
      --ink:#d84a3a;  /* chữ hồng đỏ */
      --muted:#a8736e;
      --accent:#d84a3a;
      --accent-weak:#fcebea;
      --border:#f8bfb9;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;
      background:url('anhtrang1.png') no-repeat center center fixed;
      background-size:cover;
      color:var(--ink);
    }
    /* phủ mờ 70% ảnh nền để nổi khung chính */
    body::before{
      content:""; position:fixed; inset:0; background:rgba(255,255,255,0.7); z-index:-1;
    }

    header{position:sticky;top:0;background:rgba(255,255,255,0.6);backdrop-filter:saturate(180%) blur(6px);border-bottom:1px solid var(--border);z-index:10}
    .wrap{max-width:880px;margin:0 auto;padding:16px}
    h1{font-size:22px;margin:0 0 6px 0;color:var(--ink);}
    .sub{font-size:12px;color:var(--muted);}
    .panel{display:grid;grid-template-columns:1fr auto auto;gap:8px;align-items:center;margin-top:10px}
    .controls{display:flex;gap:6px;flex-wrap:wrap;align-items:center}
    input[type="text"]{padding:10px 12px;border:1px solid var(--border);border-radius:10px;outline:none;width:100%;background:#fff}
    input[type="text"]:focus{border-color:var(--accent)}
    button{border:1px solid var(--border);background:#fff;border-radius:12px;padding:10px 14px;cursor:pointer;color:var(--ink)}
    button.primary{background:var(--accent);border-color:transparent;color:#fff}
    button.ghost{background:var(--accent-weak);border-color:transparent;color:var(--ink)}
    button:disabled{opacity:.5;cursor:not-allowed}
    .pill{font-size:12px;padding:6px 10px;border-radius:999px;border:1px solid var(--border);background:#fff;color:var(--muted)}

    main{display:grid;justify-items:center;padding:20px}

    /* Card */
    .stage{width:min(600px,94vw);height:min(60vh,520px);min-height:360px;display:grid;place-items:center;margin:18px 0}
    .card{width:100%;height:100%;border-radius:20px;background:var(--card);box-shadow:0 14px 36px rgba(216,74,58,.18);cursor:pointer;perspective:1200px;position:relative;border:1px solid var(--border)}
    .card-inner{position:absolute;inset:0;border-radius:20px;transform-style:preserve-3d;transition:transform .6s}
    .card.flipped .card-inner{transform:rotateY(180deg)}
    .face{position:absolute;inset:0;display:flex;flex-direction:column;justify-content:center;align-items:center;gap:14px;padding:28px;border-radius:20px;backface-visibility:hidden}
    .front{background:linear-gradient(180deg,#f2d7d3, #f9e5e2)}
    .front h2{font-size:40px;line-height:1.1;margin:0;text-align:center;color:var(--ink)}
    .badge{font-size:12px;color:var(--ink);background:var(--accent-weak);padding:6px 10px;border-radius:999px;border:1px dashed var(--border)}
    .back{transform:rotateY(180deg);background:var(--card)}
    .meaning{font-size:20px;line-height:1.45;text-align:center;color:var(--ink)}
    .muted{color:var(--muted)}

    /* Footer controls */
    .nav{display:flex;gap:10px;align-items:center;justify-content:center}
    .counter{font-size:14px;color:var(--muted)}

    /* Add/Edit form */
    details.box{width:min(600px,94vw);background:#fff;border:1px solid var(--border);border-radius:16px;padding:12px 12px 16px;box-shadow:0 10px 24px rgba(2,6,23,.05)}
    details.box>summary{cursor:pointer;list-style:none;padding:6px 2px;font-weight:600;color:var(--ink)}
    details.box[open]>summary{margin-bottom:8px}
    .grid{display:grid;grid-template-columns:1fr 1fr 1fr;gap:8px}
    .row{display:flex;gap:8px;flex-wrap:wrap;align-items:center}
    label{font-size:12px;color:var(--muted)}
    .hint{font-size:12px;color:var(--muted)}
    .tiny{font-size:12px}
    .switch{display:inline-flex;gap:6px;align-items:center;padding:6px 10px;border:1px solid var(--border);border-radius:999px;background:#fff;color:var(--ink)}
    .foot{display:flex;gap:8px;align-items:center;justify-content:space-between;margin-top:8px}

    @media (max-width:760px){
      .grid{grid-template-columns:1fr}
      .panel{grid-template-columns:1fr;gap:6px}
    }
  </style>
</head>
<body>
  <header>
    <div class="wrap">
      <h1>Flashcards of Hjyeon</h1>
      <div class="sub">Nhấp vào thẻ để lật • Space: lật | ←/→: chuyển thẻ | Enter: tìm kiếm</div>
      <div class="panel">
        <input id="search" type="text" placeholder="Tìm từ (EN/KO/VI)…" />
        <div class="controls">
          <label class="switch"><input id="toggle-ko" type="checkbox" checked> <span>Hiện tiếng Hàn</span></label>
          <label class="switch"><input id="toggle-vi" type="checkbox" checked> <span>Hiện tiếng Việt</span></label>
          <button id="shuffle" class="ghost" title="Xáo trộn">🔀 Xáo</button>
        </div>
        <div class="controls">
          <button id="btn-export" title="Xuất JSON">⬇️ Xuất</button>
          <label class="switch" title="Nhập JSON"><input id="file" type="file" accept="application/json"> <span>⬆️ Nhập</span></label>
        </div>
      </div>
    </div>
  </header>

  <main>
    <div class="stage">
      <div id="card" class="card" aria-live="polite" role="button" tabindex="0">
        <div class="card-inner">
          <div class="face front">
            <span class="badge">EN</span>
            <h2 id="front-word">loading…</h2>
            <div class="hint">Nhấp để xem nghĩa</div>
          </div>
          <div class="face back">
            <div class="badge">KO • VI</div>
            <div class="meaning" id="back-meaning"></div>
            <div class="hint muted">Nhấp để quay lại</div>
          </div>
        </div>
      </div>
    </div>

    <div class="nav">
      <button id="prev">◀︎ Trước</button>
      <button id="flip" class="primary">Lật thẻ</button>
      <button id="next">Sau ▶︎</button>
      <span class="counter" id="counter">0 / 0</span>
      <button id="edit" title="Sửa thẻ hiện tại">✏️ Sửa</button>
      <button id="del" title="Xoá thẻ hiện tại" style="color:#b91c1c;border-color:#fecaca;background:#fff0f0">🗑️ Xoá</button>
    </div>

    <details class="box">
      <summary>＋ Thêm từ mới</summary>
      <div class="grid">
        <div>
          <label>English</label>
          <input id="in-en" type="text" placeholder="vd. innovative" />
        </div>
        <div>
          <label>한국어 뜻</label>
          <input id="in-ko" type="text" placeholder="vd. 혁신적인" />
        </div>
        <div>
          <label>Tiếng Việt</label>
          <input id="in-vi" type="text" placeholder="vd. đổi mới, sáng tạo" />
        </div>
      </div>
      <div class="foot">
        <span class="tiny muted">Mẹo: thêm nhanh rồi Enter để lưu.</span>
        <div class="row">
          <button id="add" class="primary">Lưu từ</button>
          <button id="clear-all" title="Xoá toàn bộ bộ thẻ" style="border-color:#fecaca">🧹 Xoá tất cả</button>
        </div>
      </div>
    </details>

    <p class="tiny muted" style="margin-top:14px">Dữ liệu được lưu tự động trong trình duyệt (localStorage). Bạn có thể Xuất/Nhập JSON để sao lưu.</p>
  </main>

  <script>
  (function(){
    const LS_KEY = 'flatcards_v1';
    const $ = (sel)=>document.querySelector(sel);

    const sample = [

      {en:'Abbreviation', ko:'약자, 줄임말', vi:'Từ viết tắt thường dùng trong thương mại như FOB, CIF, L/C.'},
      {en:'Abandon', ko:'버리다, 위부하다', vi:'Từ bỏ quyền lợi hoặc nghĩa vụ theo hợp đồng.'},
{en:'Acceptance', ko:'승낙, (어음의) 인수, (서류 등의) 수락', vi:'Sự đồng ý với đề nghị hoặc sự chấp nhận hối phiếu.'},
{en:'Account', ko:'계정, 거래, ~을 설명하다', vi:'Tài khoản tài chính hoặc sự giải thích cho một vấn đề.'},
{en:'Account receivables', ko:'외상매출채권, 미수금', vi:'Khoản phải thu từ khách hàng.'},
{en:'Accommodate', ko:'제공하다', vi:'Cung cấp, đáp ứng một yêu cầu hoặc nhu cầu.'},
{en:'Address', ko:'주소, 보내다, 다루다, 처리하다', vi:'Xử lý, giải quyết hoặc gửi đến địa chỉ.'},
{en:'Advance payment', ko:'선지급방식', vi:'Phương thức thanh toán trước khi giao hàng.'},
{en:'Advise', ko:'통지, 권고하다, 알리다', vi:'Thông báo, khuyến nghị hoặc tư vấn.'},
{en:'Advising Bank', ko:'통지은행', vi:'Ngân hàng thông báo L/C cho người thụ hưởng.'},
{en:'After Sight', ko:'일람 후', vi:'Thanh toán sau khi xuất trình hối phiếu.'},
{en:'Agent', ko:'대리인, 대리점', vi:'Người hoặc công ty đại diện thay mặt bên khác.'},
{en:'Agreement', ko:'합의, 계약', vi:'Thỏa thuận giữa các bên liên quan.'},
{en:'Air Waybill (AWB)', ko:'항공화물운송장', vi:'Vận đơn dùng trong vận chuyển hàng không.'},
{en:'All risks', ko:'전위험담보(약관)', vi:'Bảo hiểm mọi rủi ro có thể xảy ra.'},
{en:'Amendment', ko:'개정, (신용장의) 조건변경', vi:'Sự sửa đổi, bổ sung điều kiện của hợp đồng hoặc L/C.'},
{en:'Amicably', ko:'우호적으로, 원만하게', vi:'Theo cách thân thiện, hòa giải.'},
{en:'Applicable', ko:'해당되는, 적용되는', vi:'Có thể áp dụng.'},
{en:'Applicable Law', ko:'준거법', vi:'Luật áp dụng điều chỉnh hợp đồng.'},
{en:'Applicant', ko:'(신용장의) 개설의뢰인', vi:'Người yêu cầu mở L/C.'},
{en:'Appreciate', ko:'고마워하다, 인식하다', vi:'Cảm kích, đánh giá cao.'},
{en:'Arbitration', ko:'중재', vi:'Giải quyết tranh chấp thông qua trọng tài.'},
{en:'Arbitrator', ko:'중재인', vi:'Người đứng ra phân xử tranh chấp.'},
{en:'Article', ko:'조항, 물품, 상품', vi:'Điều khoản hoặc mặt hàng.'},
{en:'Arrangement', ko:'준비, 약정, 계약', vi:'Sự sắp xếp hoặc thỏa thuận.'},
{en:'Assent', ko:'승인, 찬성', vi:'Sự đồng ý.'},
{en:'Assign', ko:'맡기다, 양도하다', vi:'Chuyển giao quyền hoặc nghĩa vụ.'},
{en:'Assignment', ko:'배정, 배치, 양도, 위탁(판매계약)', vi:'Sự chuyển nhượng hoặc phân công.'},
{en:'At sight', ko:'일람출금', vi:'Thanh toán ngay khi xuất trình chứng từ.'},
{en:'Attributable', ko:'~에 기인하는, ~의 탓으로 할 수 있는', vi:'Do nguyên nhân từ.'},
{en:'Auction', ko:'경매', vi:'Bán hàng bằng hình thức đấu giá.'},
{en:'Authority', ko:'권한, 당국, 기관', vi:'Cơ quan có thẩm quyền.'},
{en:'Authorization', ko:'허가, 승인', vi:'Sự cho phép.'},
{en:'Average', ko:'손해 (분손)', vi:'Tổn thất hàng hóa nhỏ trong vận tải.'},
{en:'Avoid', ko:'(계약을) 해제하다, 피하다', vi:'Hủy bỏ hoặc tránh nghĩa vụ hợp đồng.'},
{en:'Award rendered by arbitrators', ko:'중재인이 내린 중재판정', vi:'Phán quyết cuối cùng của trọng tài.'},
{en:'Allowance', ko:'할인, 환급(액)', vi:'Khoản giảm trừ hoặc hoàn lại.'},
{en:'Barter Trade', ko:'물물교환', vi:'Hình thức trao đổi hàng hóa không dùng tiền.'},
{en:'Alongside', ko:'~ 옆에', vi:'Cạnh bên tàu hoặc kho.'},
{en:'Bankrupt', ko:'파산한', vi:'Tình trạng mất khả năng thanh toán.'},
{en:'Alternative', ko:'대안, 대체하는', vi:'Lựa chọn thay thế.'},
{en:'Bear', ko:'부담하다, 담다, 가지다', vi:'Mang hoặc chịu trách nhiệm.'},
{en:'Beneficiary', ko:'수익자', vi:'Người thụ hưởng lợi ích trong hợp đồng hoặc L/C.'},
{en:'Berth term', ko:'하역비 포함 운임조건', vi:'Điều kiện bao gồm chi phí xếp dỡ tại cảng.'},
{en:'Bid', ko:'입찰', vi:'Đưa giá trong đấu thầu.'},
{en:'Breach', ko:'계약의 위반', vi:'Sự vi phạm điều khoản hợp đồng.'},
{en:'Bulk Cargo', ko:'벌크화물, 산적화물', vi:'Hàng hóa không đóng gói, vận chuyển rời.'},
{en:'Cargo Insurance', ko:'적하보험', vi:'Bảo hiểm hàng hóa vận chuyển.'},
{en:'Carriage', ko:'운송, 운임', vi:'Việc chuyên chở hoặc cước phí.'},
{en:'Carrier', ko:'운송인', vi:'Người hoặc công ty vận chuyển hàng.'},
{en:'Carry out', ko:'실행하다', vi:'Thực hiện.'},
{en:'Certain', ko:'확실한', vi:'Chắc chắn.'},
{en:'Certificate of Analysis', ko:'성분분석서', vi:'Chứng nhận phân tích thành phần.'},
{en:'Certificate of Origin', ko:'원산지증명서', vi:'Giấy chứng nhận xuất xứ.'},
{en:'Charge', ko:'요금, 청구하다', vi:'Phí hoặc yêu cầu thanh toán.'},
{en:'Charter party', ko:'용선계약', vi:'Hợp đồng thuê tàu.'},
{en:'Charterer', ko:'용선자', vi:'Người thuê tàu.'},
{en:'Circumstance', ko:'상황', vi:'Hoàn cảnh.'},
{en:'Claim', ko:'청구, 요구', vi:'Yêu cầu bồi thường hoặc quyền lợi.'},
{en:'Classification', ko:'분류', vi:'Sự phân loại.'},
{en:'Clause', ko:'조항', vi:'Điều khoản trong hợp đồng.'},
{en:'Clean B/L', ko:'청결 선하증권', vi:'Vận đơn sạch, không ghi chú hư hỏng.'},
{en:'Clean Credit', ko:'청결 신용장', vi:'L/C không có điều kiện đặc biệt.'},
{en:'Collateral', ko:'담보', vi:'Tài sản đảm bảo.'},
{en:'Collecting bank', ko:'추심은행', vi:'Ngân hàng thu hộ.'},
{en:'Commercial', ko:'상업의', vi:'Liên quan đến thương mại.'},
{en:'Commodity', ko:'상품', vi:'Hàng hóa.'},
{en:'Competitive', ko:'경쟁력 있는', vi:'Có khả năng cạnh tranh.'},
{en:'Completion', ko:'완료', vi:'Sự hoàn thành.'},
{en:'Comply', ko:'준수하다', vi:'Tuân thủ.'},
{en:'Conclude', ko:'체결하다', vi:'Ký kết.'},
{en:'Concurrent', ko:'동시의', vi:'Xảy ra cùng lúc.'},
{en:'Condition', ko:'조건', vi:'Điều kiện.'},
{en:'Conditional Offer', ko:'조건부 제안', vi:'Chào hàng có điều kiện.'},
{en:'Confidential', ko:'기밀의', vi:'Bảo mật.'},
{en:'Conformity', ko:'적합성', vi:'Sự phù hợp.'},
{en:'Connection', ko:'연결', vi:'Mối liên hệ.'},
{en:'Consent', ko:'동의', vi:'Sự đồng ý.'},
{en:'Consequently', ko:'결과적으로', vi:'Do đó.'},
{en:'Consideration', ko:'고려, 대가', vi:'Sự cân nhắc hoặc khoản bồi hoàn trong hợp đồng.'},
{en:'Consignee', ko:'수화인', vi:'Người nhận hàng.'},
{en:'Consignment', ko:'위탁화물', vi:'Lô hàng gửi.'},
{en:'Consignor', ko:'송화인', vi:'Người gửi hàng.'},
{en:'Consolidation', ko:'통합', vi:'Gộp hàng.'},
{en:'Constitute', ko:'구성하다', vi:'Cấu thành.'},
{en:'Consultation', ko:'협의', vi:'Sự tư vấn, tham vấn.'},
{en:'Consumption', ko:'소비', vi:'Sự tiêu dùng.'},
{en:'Contract of affreightment (COA)', ko:'운송계약', vi:'Hợp đồng vận chuyển hàng hóa.'},
{en:'Contracting State', ko:'계약 체결국', vi:'Quốc gia ký kết.'},
{en:'Convenient', ko:'편리한', vi:'Thuận tiện.'},
{en:'Convention', ko:'협약', vi:'Công ước.'},
{en:'Convert', ko:'전환하다', vi:'Chuyển đổi.'},
{en:'Conveyance', ko:'운송수단', vi:'Phương tiện vận chuyển.'},
{en:'Correspond', ko:'일치하다', vi:'Tương ứng, phù hợp.'},
{en:'Correspondence', ko:'서신', vi:'Thư từ, giao tiếp văn bản.'},
{en:'Correspondent bank', ko:'코레스은행', vi:'Ngân hàng đại lý.'},
{en:'Counterpart', ko:'상대방', vi:'Bên đối tác.'},
{en:'Covenant', ko:'계약, 약속', vi:'Điều khoản hoặc cam kết trong hợp đồng.'},
{en:'Cover', ko:'보장하다', vi:'Bảo hiểm hoặc bao gồm.'},
{en:'Creditor', ko:'채권자', vi:'Chủ nợ.'},
{en:'Credit-worthiness', ko:'신용도', vi:'Mức độ tín nhiệm.'},
{en:'Cumulative', ko:'누적적인', vi:'Tích lũy.'},
{en:'Currency exchange rate', ko:'환율', vi:'Tỷ giá hối đoái.'},
{en:'Customs clearance', ko:'통관', vi:'Thông quan.'},
{en:'Debit', ko:'차변', vi:'Ghi nợ.'},
{en:'Debtor', ko:'채무자', vi:'Người mắc nợ.'},
{en:'Deduction', ko:'공제', vi:'Khoản khấu trừ.'},
{en:'Deem', ko:'간주하다', vi:'Cho là, xem như.'},
{en:'Deferred payment', ko:'연기지급', vi:'Thanh toán hoãn lại.'},
{en:'Definite', ko:'확정적인', vi:'Chắc chắn, rõ ràng.'},
{en:'Deliberate', ko:'의도적인', vi:'Cố ý.'},
{en:'Delivery', ko:'인도', vi:'Giao hàng.'},
{en:'Demurrage', ko:'체화료', vi:'Phí lưu kho, lưu bãi.'},
{en:'Dependent', ko:'의존적인', vi:'Phụ thuộc.'},
{en:'Depot', ko:'창고', vi:'Kho bãi.'},
{en:'Description', ko:'설명', vi:'Mô tả.'},
{en:'Despite', ko:'불구하고', vi:'Mặc dù.'},
{en:'Destination', ko:'목적지', vi:'Điểm đến.'},
{en:'Detention charge', ko:'체선료', vi:'Phí lưu container.'},
{en:'Determine', ko:'결정하다', vi:'Xác định.'},
{en:'Disburse', ko:'지불하다', vi:'Chi trả.'},
{en:'Discharge', ko:'양하하다', vi:'Dỡ hàng.'},
{en:'Disclose', ko:'공개하다', vi:'Tiết lộ.'},
{en:'Discrepancy', ko:'불일치', vi:'Sự sai lệch.'},
{en:'Dispatch', ko:'발송', vi:'Gửi đi.'},
{en:'Dispose', ko:'처분하다', vi:'Xử lý, vứt bỏ.'},
{en:'Dispute', ko:'분쟁', vi:'Tranh chấp.'},
{en:'Distress', ko:'조난', vi:'Tình trạng nguy cấp.'},
{en:'Distributor', ko:'유통업자', vi:'Nhà phân phối.'},
{en:'Division', ko:'부서', vi:'Bộ phận, phòng ban.'},
{en:'Documentary Credit (DC)', ko:'화환신용장', vi:'Tín dụng chứng từ.'},
{en:'Domestic', ko:'국내의', vi:'Nội địa.'},
{en:'Domicile', ko:'주소지', vi:'Nơi cư trú, địa chỉ đăng ký.'},
{en:'Draft', ko:'환어음', vi:'Hối phiếu.'},
{en:'Draw', ko:'발행하다', vi:'Phát hành.'},
{en:'Drawee', ko:'지급인', vi:'Người bị đòi tiền.'},
{en:'Drawer', ko:'발행인', vi:'Người phát hành.'},
{en:'Due', ko:'만기된', vi:'Đến hạn.'},
{en:'Duplicate', ko:'복사본', vi:'Bản sao.'},
{en:'Duty', ko:'관세', vi:'Thuế.'},
{en:'Elsewhere', ko:'다른 곳에', vi:'Nơi khác.'},
{en:'Enclosed', ko:'동봉된', vi:'Kèm theo.'},
{en:'Endorsement', ko:'배서', vi:'Ký hậu.'},
{en:'Engagement', ko:'약속', vi:'Cam kết.'},
{en:'Enforce', ko:'시행하다', vi:'Thi hành.'},
{en:'Ensure', ko:'보장하다', vi:'Đảm bảo.'},
{en:'Entitle', ko:'자격을 주다', vi:'Trao quyền.'},
{en:'Equilibrium', ko:'균형', vi:'Cán cân.'},
{en:'Equipment', ko:'장비', vi:'Trang thiết bị.'},
{en:'Escalation clause', ko:'가격조정조항', vi:'Điều khoản điều chỉnh giá.'},
{en:'Establish', ko:'설립하다', vi:'Thành lập.'},
{en:'Evidence', ko:'증거', vi:'Bằng chứng.'},
{en:'Exception', ko:'예외', vi:'Ngoại lệ.'},
{en:'Exclusive', ko:'독점적인', vi:'Độc quyền.'},
{en:'Execution', ko:'집행', vi:'Thi hành.'},
{en:'Expense', ko:'비용', vi:'Chi phí.'},
{en:'Explosion', ko:'폭발', vi:'Vụ nổ.'},
{en:'Explicit', ko:'명백한', vi:'Rõ ràng.'},
{en:'Expressly', ko:'명시적으로', vi:'Một cách rõ ràng.'},
{en:'Extent', ko:'범위', vi:'Mức độ.'},
{en:'Fabric', ko:'직물', vi:'Vải.'},
{en:'Face value', ko:'액면가', vi:'Mệnh giá.'},
{en:'Facility', ko:'시설', vi:'Cơ sở vật chất.'},
{en:'Favorable', ko:'유리한', vi:'Thuận lợi.'},
{en:'Fiscal', ko:'재정의', vi:'Tài chính.'},
{en:'Force Majeure', ko:'불가항력', vi:'Bất khả kháng.'},
{en:'Formality', ko:'형식', vi:'Thủ tục hình thức.'},
{en:'Freight', ko:'화물, 운임', vi:'Cước phí.'},
{en:'Fund', ko:'기금', vi:'Quỹ.'},
{en:'Furnish', ko:'제공하다', vi:'Cung cấp.'},
{en:'General', ko:'일반적인', vi:'Chung.'},
{en:'Govern', ko:'지배하다', vi:'Chi phối.'},
{en:'Grant', ko:'부여하다', vi:'Ban hành.'},
{en:'Guarantee', ko:'보증', vi:'Bảo lãnh.'},
{en:'Guidance note', ko:'설명서', vi:'Hướng dẫn.'},
{en:'Hand over', ko:'인도하다', vi:'Bàn giao.'},
{en:'Harbor', ko:'항구', vi:'Bến cảng.'},
{en:'Hereby', ko:'이에 의하여', vi:'Bằng văn bản này.'},
{en:'Herein', ko:'여기에', vi:'Tại đây.'},
{en:'Hereto', ko:'이에', vi:'Gắn kèm.'},
{en:'Holder', ko:'소지자', vi:'Người giữ.'},
{en:'Honour', ko:'이행하다', vi:'Thực hiện (trả tiền).'},
{en:'Identification', ko:'식별', vi:'Nhận dạng.'},
{en:'Immediately', ko:'즉시', vi:'Ngay lập tức.'},
{en:'Implicitly', ko:'암묵적으로', vi:'Ngầm hiểu.'},
{en:'Import duty', ko:'수입관세', vi:'Thuế nhập khẩu.'},
{en:'Impose', ko:'부과하다', vi:'Áp đặt.'},

{en:'Inactivity', ko:'비활동', vi:'Không hoạt động.'},
{en:'Incidental', ko:'부수적인', vi:'Phụ thêm.'},
{en:'Inconvenience', ko:'불편', vi:'Bất tiện.'},
{en:'Incur', ko:'초래하다', vi:'Gánh chịu.'},
{en:'Indebtedness', ko:'채무', vi:'Khoản nợ.'},
{en:'Indemnity', ko:'배상', vi:'Bồi thường.'},
{en:'Indicate', ko:'지시하다', vi:'Chỉ rõ.'},
{en:'Inform', ko:'알리다', vi:'Thông báo.'},
{en:'Infringe', ko:'침해하다', vi:'Xâm phạm.'},
{en:'Initial', ko:'처음의', vi:'Ban đầu.'},
{en:'Inquiry', ko:'문의', vi:'Yêu cầu thông tin.'},
{en:'Insolvent', ko:'지급불능', vi:'Vỡ nợ.'},
{en:'Inspection', ko:'검사', vi:'Kiểm tra.'},
{en:'Inspection certificate', ko:'검사증명서', vi:'Giấy chứng nhận kiểm định.'},
{en:'Instal', ko:'설치하다', vi:'Lắp đặt.'},
{en:'Instalment shipment', ko:'할부선적', vi:'Giao hàng từng phần.'},
{en:'Institute Cargo Clause (ICC)', ko:'적하약관', vi:'Điều khoản bảo hiểm hàng hóa.'},
{en:'Instrument', ko:'문서', vi:'Chứng từ.'},
{en:'Insurance Certificate', ko:'보험증서', vi:'Giấy chứng nhận bảo hiểm.'},
{en:'Insurance Claim', ko:'보험청구', vi:'Yêu cầu bồi thường.'},
{en:'Intention', ko:'의도', vi:'Ý định.'},
{en:'Intermediary', ko:'중개인', vi:'Trung gian.'},
{en:'Interior', ko:'내륙', vi:'Nội địa.'},
{en:'Interpret', ko:'해석하다', vi:'Diễn giải.'},
{en:'Invalidate', ko:'무효화하다', vi:'Làm mất hiệu lực.'},
{en:'Invoice', ko:'송장', vi:'Hóa đơn.'},
{en:'Irrevocable', ko:'취소불능', vi:'Không thể hủy.'},
{en:'Jettison', ko:'투하', vi:'Vứt bỏ (hàng trên tàu).'},
{en:'Labour', ko:'노동', vi:'Lao động.'},
{en:'Lawsuit', ko:'소송', vi:'Vụ kiện.'},
{en:'Legal', ko:'법률의', vi:'Pháp lý.'},
{en:'Liability', ko:'책임', vi:'Trách nhiệm.'},
{en:'Liquidated Damages', ko:'손해배상금', vi:'Tiền phạt vi phạm.'},
{en:'Litigation', ko:'소송', vi:'Tranh tụng.'},
{en:'Look forward to', ko:'~을 기대하다', vi:'Mong chờ.'},
{en:'Maker', ko:'발행인', vi:'Người lập (hối phiếu).'},
{en:'Mandatory rules', ko:'강제규정', vi:'Quy định bắt buộc.'},
{en:'Marine B/L', ko:'해상 선하증권', vi:'Vận đơn đường biển.'},
{en:'Marine Insurance Policy', ko:'해상보험증권', vi:'Chứng từ bảo hiểm hàng hải.'},
{en:'Maritime', ko:'해양의', vi:'Hàng hải.'},
{en:'Maturity', ko:'만기', vi:'Đến hạn.'},
{en:'Mention', ko:'언급', vi:'Đề cập.'},
{en:'Merchandise', ko:'상품', vi:'Hàng hóa.'},
{en:'Misconduct', ko:'위법 행위', vi:'Hành vi sai trái.'},
{en:'Modes of Transport', ko:'운송수단', vi:'Phương thức vận chuyển.'},
{en:'Multimodal Transport', ko:'복합운송', vi:'Vận chuyển đa phương thức.'},
{en:'Mutually', ko:'상호 간에', vi:'Lẫn nhau.'},
{en:'Nationality', ko:'국적', vi:'Quốc tịch.'},
{en:'Negotiable', ko:'양도 가능한', vi:'Có thể chuyển nhượng.'},
{en:'Negotiate', ko:'협상하다', vi:'Đàm phán.'},
{en:'Nominate', ko:'지명하다', vi:'Chỉ định.'},
{en:'Non-negotiable B/L', ko:'비유통 선하증권', vi:'Vận đơn không chuyển nhượng.'},
{en:'Notwithstanding', ko:'~에도 불구하고', vi:'Mặc dù.'},
{en:'Notify party', ko:'통지처', vi:'Bên được thông báo.'},
{en:'Obligation', ko:'의무', vi:'Nghĩa vụ.'},
{en:'Obligee', ko:'권리자', vi:'Người có quyền.'},
{en:'Obligor', ko:'채무자', vi:'Người có nghĩa vụ.'},
{en:'Observe', ko:'준수하다', vi:'Tuân thủ.'},
{en:'Obtain', ko:'얻다', vi:'Đạt được.'},
{en:'Occurrence', ko:'사건', vi:'Sự kiện.'},
{en:'Offer', ko:'제의, 제안', vi:'Chào hàng.'},
{en:'Offshore', ko:'해외의', vi:'Ngoài khơi, nước ngoài.'},
{en:'On behalf of', ko:'~를 대신하여', vi:'Thay mặt cho.'},
{en:'On deck B/L', ko:'갑판적재 선하증권', vi:'Vận đơn xếp trên boong.'},
{en:'Open account', ko:'기록계정거래', vi:'Tài khoản mở (thanh toán sau).'},
{en:'Operate', ko:'운영하다', vi:'Vận hành.'},
{en:'Optional', ko:'선택적인', vi:'Tùy chọn.'},
{en:'Order B/L', ko:'지시식 선하증권', vi:'Vận đơn theo lệnh.'},
{en:'Outstanding', ko:'미결제의', vi:'Chưa thanh toán.'},
{en:'Overdue', ko:'기한을 넘긴', vi:'Quá hạn.'},
{en:'Overseas', ko:'해외의', vi:'Nước ngoài.'},
{en:'Ownership', ko:'소유권', vi:'Quyền sở hữu.'},
{en:'Packing list', ko:'포장명세서', vi:'Phiếu đóng gói.'},
{en:'Part shipment', ko:'분할선적', vi:'Giao hàng từng phần.'},
{en:'Partial', ko:'부분적인', vi:'Một phần.'},
{en:'Particular average', ko:'분손', vi:'Tổn thất bộ phận.'},
{en:'Parties', ko:'당사자', vi:'Các bên.'},
{en:'Payment in advance', ko:'선지급', vi:'Thanh toán trước.'},
{en:'Penalty', ko:'벌금', vi:'Tiền phạt.'},
{en:'Performance', ko:'이행', vi:'Thực hiện.'},
{en:'Peril', ko:'위험', vi:'Nguy cơ.'},
{en:'Permit', ko:'허가하다', vi:'Cho phép.'},
{en:'Persuade', ko:'설득하다', vi:'Thuyết phục.'},
{en:'Petition', ko:'청원', vi:'Đơn kiến nghị.'},
{en:'Place of delivery', ko:'인도 장소', vi:'Địa điểm giao hàng.'},
{en:'Policy holder', ko:'보험계약자', vi:'Người mua bảo hiểm.'},
{en:'Port of discharge', ko:'양하지', vi:'Cảng dỡ hàng.'},
{en:'Port of loading', ko:'적하지', vi:'Cảng bốc hàng.'},
{en:'Possession', ko:'소유', vi:'Sự sở hữu.'},
{en:'Potential', ko:'잠재적인', vi:'Tiềm năng.'},
{en:'Practicable', ko:'실행 가능한', vi:'Khả thi.'},
{en:'Precaution', ko:'예방조치', vi:'Biện pháp phòng ngừa.'},
{en:'Preferential duty', ko:'특혜관세', vi:'Thuế ưu đãi.'},
{en:'Premium', ko:'보험료', vi:'Phí bảo hiểm.'},
{en:'Prescribe', ko:'규정하다', vi:'Quy định.'},
{en:'Principal', ko:'본인, 원금', vi:'Nguyên tắc / Tiền gốc.'},
{en:'Prior consent', ko:'사전동의', vi:'Sự đồng ý trước.'},
{en:'Privilege', ko:'특권', vi:'Đặc quyền.'},
{en:'Proceed', ko:'진행하다', vi:'Tiến hành.'},
{en:'Procurement', ko:'조달', vi:'Mua sắm.'},
{en:'Produce', ko:'생산하다', vi:'Sản xuất.'},
{en:'Product liability', ko:'제조물 책임', vi:'Trách nhiệm sản phẩm.'},
{en:'Profit', ko:'이익', vi:'Lợi nhuận.'},
{en:'Proforma Invoice', ko:'견적송장', vi:'Hóa đơn chiếu lệ.'},
{en:'Prohibit', ko:'금지하다', vi:'Cấm.'},
{en:'Promissory Note', ko:'약속어음', vi:'Kỳ phiếu.'},
{en:'Promptly', ko:'신속히', vi:'Ngay lập tức.'},
{en:'Property', ko:'재산', vi:'Tài sản.'},
{en:'Proprietor', ko:'소유자', vi:'Chủ sở hữu.'},
{en:'Prosecute', ko:'기소하다', vi:'Khởi tố.'},
{en:'Protest', ko:'항의', vi:'Kháng nghị.'},
{en:'Provide', ko:'제공하다', vi:'Cung cấp.'},
{en:'Provisional', ko:'잠정적인', vi:'Tạm thời.'},
{en:'Purchase order', ko:'구매주문서', vi:'Đơn đặt hàng.'},
{en:'Purpose', ko:'목적', vi:'Mục đích.'},
{en:'Quantity', ko:'수량', vi:'Số lượng.'},
{en:'Quarantine', ko:'검역', vi:'Cách ly kiểm dịch.'},
{en:'Quotation', ko:'견적', vi:'Báo giá.'},
{en:'Rate', ko:'요율', vi:'Tỷ lệ, mức phí.'},
{en:'Receipt', ko:'영수증', vi:'Biên lai.'},
{en:'Recipient', ko:'수취인', vi:'Người nhận.'},
{en:'Recourse', ko:'상환청구권', vi:'Quyền truy đòi.'},
{en:'Red clause L/C', ko:'적색조건 신용장', vi:'Thư tín dụng điều khoản đỏ.'},
{en:'Refund', ko:'환불', vi:'Hoàn tiền.'},
{en:'Refuse', ko:'거절하다', vi:'Từ chối.'},
{en:'Regard', ko:'간주하다', vi:'Xem như.'},
{en:'Regulation', ko:'규정', vi:'Quy định.'},
{en:'Reimbursement', ko:'상환', vi:'Hoàn trả.'},
{en:'Reject', ko:'거부하다', vi:'Từ chối.'},
{en:'Release', ko:'석방, 발행하다', vi:'Phát hành, giải phóng.'},
{en:'Remedy', ko:'구제수단', vi:'Biện pháp khắc phục.'},
{en:'Remit', ko:'송금하다', vi:'Chuyển tiền.'},
{en:'Renewal', ko:'갱신', vi:'Gia hạn.'},
{en:'Replacement', ko:'교체', vi:'Thay thế.'},
{en:'Reply', ko:'답장하다', vi:'Trả lời.'},
{en:'Representative', ko:'대표자', vi:'Người đại diện.'},
{en:'Reputation', ko:'평판', vi:'Danh tiếng.'},
{en:'Request', ko:'요청하다', vi:'Yêu cầu.'},
{en:'Require', ko:'요구하다', vi:'Đòi hỏi.'},
{en:'Reservation', ko:'예약, 유보', vi:'Đặt chỗ / Bảo lưu.'},
{en:'Respective', ko:'각자의', vi:'Tương ứng.'},
{en:'Restore', ko:'복구하다', vi:'Khôi phục.'},
{en:'Restriction', ko:'제한', vi:'Hạn chế.'},
{en:'Retain', ko:'보유하다', vi:'Giữ lại.'},
{en:'Retrieve', ko:'되찾다', vi:'Thu hồi.'},
{en:'Revocation', ko:'취소', vi:'Hủy bỏ.'},
{en:'Revoke', ko:'취소하다', vi:'Thu hồi.'},
{en:'Risk', ko:'위험', vi:'Rủi ro.'},
{en:'Routing', ko:'항로', vi:'Tuyến đường.'},
{en:'Sale confirmation', ko:'판매확인서', vi:'Xác nhận bán hàng.'},
{en:'Salvage', ko:'구난', vi:'Cứu hộ hàng hóa.'},
{en:'Sample', ko:'견본', vi:'Mẫu hàng.'},
{en:'Schedule', ko:'일정', vi:'Lịch trình.'},
{en:'Seize', ko:'압류하다', vi:'Tịch thu.'},
{en:'Seller', ko:'판매자', vi:'Người bán.'},
{en:'Settlement', ko:'결제', vi:'Thanh toán.'},
{en:'Shipment', ko:'선적', vi:'Giao hàng, xếp hàng lên tàu.'},
{en:'Shipper', ko:'선적인', vi:'Người gửi hàng.'},
{en:'Shipping advice', ko:'선적통지', vi:'Thông báo giao hàng.'},
{en:'Shipping documents', ko:'선적서류', vi:'Chứng từ vận chuyển.'},
{en:'Short shipment', ko:'부족선적', vi:'Thiếu hàng.'},
{en:'Sight draft', ko:'일람출급 환어음', vi:'Hối phiếu trả ngay.'},
{en:'Signature', ko:'서명', vi:'Chữ ký.'},
{en:'Slip', ko:'전표', vi:'Phiếu ghi.'},
{en:'Solvent', ko:'지급능력 있는', vi:'Có khả năng thanh toán.'},
{en:'Specification', ko:'명세서', vi:'Quy cách, chi tiết kỹ thuật.'},
{en:'Specify', ko:'명시하다', vi:'Ghi rõ.'},
{en:'State', ko:'명시하다', vi:'Trình bày, tuyên bố.'},
{en:'Statute', ko:'법령', vi:'Đạo luật.'},
{en:'Stipulate', ko:'규정하다', vi:'Quy định.'},
{en:'Subsequent', ko:'이후의', vi:'Tiếp theo.'},
{en:'Substitute', ko:'대체하다', vi:'Thay thế.'},
{en:'Sue', ko:'고소하다', vi:'Kiện.'},
{en:'Suffer', ko:'겪다', vi:'Chịu đựng.'},
{en:'Supplementary', ko:'보충의', vi:'Bổ sung.'},
{en:'Surcharge', ko:'할증료', vi:'Phụ phí.'},
{en:'Survey', ko:'검사, 조사', vi:'Khảo sát / Giám định.'},
{en:'Take place', ko:'일어나다', vi:'Diễn ra.'},
{en:'Tariff', ko:'관세율표', vi:'Biểu thuế.'},
{en:'Tender', ko:'입찰', vi:'Chào thầu.'},
{en:'Terminate', ko:'종결하다', vi:'Chấm dứt.'},
{en:'Terms of contract', ko:'계약조건', vi:'Điều khoản hợp đồng.'},
{en:'Terms of trade', ko:'교역조건', vi:'Điều kiện thương mại.'},
{en:'Thereof', ko:'그것의', vi:'Của cái đó.'},
{en:'Title', ko:'소유권', vi:'Quyền sở hữu.'},
{en:'Ton', ko:'톤', vi:'Tấn.'},
{en:'Total loss', ko:'전손', vi:'Tổn thất toàn bộ.'},
{en:'Trade mark', ko:'상표', vi:'Thương hiệu.'},
{en:'Transaction', ko:'거래', vi:'Giao dịch.'},
{en:'Transferable L/C', ko:'양도가능 신용장', vi:'Thư tín dụng có thể chuyển nhượng.'},
{en:'Transit', ko:'통과', vi:'Quá cảnh.'},
{en:'Transshipment', ko:'환적', vi:'Chuyển tải.'},
{en:'Transportation', ko:'운송', vi:'Vận tải.'},
{en:'Treaty', ko:'조약', vi:'Hiệp ước.'},
{en:'Trust receipt (T/R)', ko:'신탁수리증권', vi:'Biên lai tín thác.'},
{en:'Trustee', ko:'수탁자', vi:'Người được ủy thác.'},
{en:'Ultimate consignee', ko:'최종 수화인', vi:'Người nhận hàng cuối cùng.'},
{en:'Undertake', ko:'착수하다, 보증하다', vi:'Đảm nhận, cam kết.'},
{en:'Unless', ko:'~하지 않는 한', vi:'Trừ khi.'},
{en:'Unpaid', ko:'미지급의', vi:'Chưa thanh toán.'},
{en:'Uphold', ko:'지지하다', vi:'Ủng hộ.'},
{en:'Usance draft', ko:'기한부 환어음', vi:'Hối phiếu kỳ hạn.'},
{en:'Valid', ko:'유효한', vi:'Có hiệu lực.'},
{en:'Validity', ko:'유효성', vi:'Tính hiệu lực.'},
{en:'Value added tax (VAT)', ko:'부가가치세', vi:'Thuế giá trị gia tăng.'},
{en:'Value date', ko:'가치일', vi:'Ngày giá trị.'},
{en:'Vehicle', ko:'차량', vi:'Phương tiện.'},
{en:'Void', ko:'무효의', vi:'Vô hiệu.'},
{en:'Volume', ko:'부피', vi:'Thể tích.'},
{en:'Waive', ko:'권리를 포기하다', vi:'Từ bỏ quyền lợi.'},
{en:'Warehouse', ko:'창고', vi:'Kho hàng.'},
{en:'Warranty', ko:'보증', vi:'Bảo hành.'},
{en:'Without recourse', ko:'상환청구권 없음', vi:'Không truy đòi.'},
{en:'Witness', ko:'증인', vi:'Nhân chứng.'},
{en:'Work out', ko:'해결하다', vi:'Giải quyết.'},
{en:'WTO', ko:'세계무역기구', vi:'Tổ chức Thương mại Thế giới.'},
   ];

let all = sample.slice();
saveAll();


    let view = all.slice();
    let idx = 0;
    let flipped = false;

    // Elements
    const card = $('#card');
    const frontWord = $('#front-word');
    const backMeaning = $('#back-meaning');
    const counter = $('#counter');
    const search = $('#search');
    const toggleKO = $('#toggle-ko');
    const toggleVI = $('#toggle-vi');

    function saveAll(){ localStorage.setItem(LS_KEY, JSON.stringify(all)); }
    function loadAll(){ return JSON.parse(localStorage.getItem(LS_KEY) || '[]'); }

    function shuffle(arr){
      for(let i=arr.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [arr[i],arr[j]]=[arr[j],arr[i]]; }
      return arr;
    }

    function render(){
      if(view.length===0){
        frontWord.textContent = 'Không có thẻ';
        backMeaning.innerHTML = '<span class="muted">Hãy thêm từ mới.</span>';
        $('#prev').disabled = $('#next').disabled = $('#flip').disabled = true;
        counter.textContent = '0 / 0';
        card.classList.remove('flipped');
        return;
      }
      $('#prev').disabled = $('#next').disabled = $('#flip').disabled = false;
      idx = (idx + view.length) % view.length;
      const c = view[idx];
      frontWord.textContent = c.en;
      const segs = [];
      if(toggleKO.checked && c.ko) segs.push(`<div><strong>KO</strong>: ${escapeHtml(c.ko)}</div>`);
      if(toggleVI.checked && c.vi) segs.push(`<div><strong>VI</strong>: ${escapeHtml(c.vi)}</div>`);
      backMeaning.innerHTML = segs.join('');
      counter.textContent = `${idx+1} / ${view.length}`;
      if(!flipped) card.classList.remove('flipped');
      else card.classList.add('flipped');

    }

    function escapeHtml(s){ return String(s).replace(/[&<>"']/g, m=>({"&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;","'":"&#39;"}[m])); }

    function applyFilter(){
      const q = search.value.trim().toLowerCase();
      view = all.filter(c=>{
        if(!q) return true;
        return [c.en,c.ko,c.vi].filter(Boolean).some(x=>x.toLowerCase().includes(q));
      });
      idx = 0; render();
    }

    // Events
    $('#flip').addEventListener('click', ()=>{ flipped=!flipped; card.classList.toggle('flipped', flipped); });
    card.addEventListener('click', ()=>{ flipped=!flipped; card.classList.toggle('flipped', flipped); });
    $('#next').addEventListener('click', ()=>{ idx++; flipped=false; render(); });
    $('#prev').addEventListener('click', ()=>{ idx--; flipped=false; render(); });

    document.addEventListener('keydown', (e)=>{
      if(e.key==='ArrowRight'){ e.preventDefault(); $('#next').click(); }
      if(e.key==='ArrowLeft'){ e.preventDefault(); $('#prev').click(); }
      if(e.key===' '){ e.preventDefault(); $('#flip').click(); }
      if(e.key==='Enter' && document.activeElement===search){ applyFilter(); }
    });

    search.addEventListener('input', ()=>{ applyFilter(); });
    $('#shuffle').addEventListener('click', ()=>{ view = shuffle(view); idx=0; flipped=false; render(); });
    toggleKO.addEventListener('change', render);
    toggleVI.addEventListener('change', render);

    // Add new card
    function addCard(en,ko,vi){
      if(!en){ alert('Vui lòng nhập English'); return; }
      all.push({en:en.trim(), ko:ko.trim(), vi:vi.trim()});
      saveAll();
      applyFilter();
      if(!search.value){ idx = all.length-1; }
      flipped=false; render();
    }

    $('#add').addEventListener('click', ()=>{
      const en=$('#in-en').value, ko=$('#in-ko').value, vi=$('#in-vi').value;
      addCard(en,ko,vi);
      $('#in-en').value = $('#in-ko').value = $('#in-vi').value = '';
      $('#in-en').focus();
    });
    ['#in-en','#in-ko','#in-vi'].forEach(sel=>$(sel).addEventListener('keydown',e=>{ if(e.key==='Enter'){ e.preventDefault(); $('#add').click(); }}));

    // Edit current
    $('#edit').addEventListener('click', ()=>{
      if(view.length===0) return;
      const curr = view[idx];
      const en = prompt('Sửa EN', curr.en); if(en===null) return;
      const ko = prompt('Sửa KO', curr.ko||'') ?? '';
      const vi = prompt('Sửa VI', curr.vi||'') ?? '';
      const masterIndex = all.findIndex(c=>c===curr || (c.en===curr.en && c.ko===curr.ko && c.vi===curr.vi));
      if(masterIndex>-1){ all[masterIndex] = {en:en.trim(), ko:ko.trim(), vi:vi.trim()}; saveAll(); applyFilter(); render(); }
    });

    // Delete current
    $('#del').addEventListener('click', ()=>{
      if(view.length===0) return;
      const curr = view[idx];
      if(!confirm(`Xoá thẻ: "${curr.en}"?`)) return;
      const masterIndex = all.findIndex(c=>c===curr || (c.en===curr.en && c.ko===curr.ko && c.vi===curr.vi));
      if(masterIndex>-1){ all.splice(masterIndex,1); saveAll(); applyFilter(); idx=0; flipped=false; render(); }
    });

    // Clear all
    $('#clear-all').addEventListener('click', ()=>{
      if(confirm('Xoá toàn bộ bộ thẻ?')){ all=[]; saveAll(); applyFilter(); render(); }
    });

    // Export JSON
    $('#btn-export').addEventListener('click', ()=>{
      const blob = new Blob([JSON.stringify(all,null,2)], {type:'application/json'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url; a.download = 'flatcards_vocab.json';
      document.body.appendChild(a); a.click(); a.remove();
      setTimeout(()=>URL.revokeObjectURL(url), 500);
    });

    // Import JSON
    $('#file').addEventListener('change', async (e)=>{
      const file = e.target.files[0]; if(!file) return;
      try{
        const text = await file.text();
        const data = JSON.parse(text);
        if(!Array.isArray(data)) throw new Error('Định dạng JSON không hợp lệ');
        all = data.map(x=>({en:String(x.en||'').trim(), ko:String(x.ko||'').trim(), vi:String(x.vi||'').trim()})).filter(x=>x.en);
        saveAll(); search.value=''; view=all.slice(); idx=0; flipped=false; render();
      }catch(err){ alert('Không thể nhập JSON: '+ err.message); }
      e.target.value='';
    });

    // First render
    applyFilter(); render();
  })();
  </script>
</body>
</html>
